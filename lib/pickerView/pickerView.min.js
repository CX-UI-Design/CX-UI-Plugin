!function(){var o={extend:function(e){for(var t=1,i=arguments.length;t<i;t++)for(var s in arguments[t])arguments[t].hasOwnProperty(s)&&(e[s]=arguments[t][s]);return e},indexOf:function(e,t){for(var i=-1,s=0,n=e.length;s<n;s++)if(e[s]===t){i=s;break}return i},css:function(e,t){for(var i in t)e.style[i]=t[i]},addClass:function(e,t){var i=e.className.split(/\s+/);-1==o.indexOf(i,t)&&i.push(t),e.className=i.join(" ")},removeClass:function(e,t){var i=e.className.split(/\s+/),s=o.indexOf(i,t);-1!==s&&i.splice(s,1),e.className=i.join(" ")},hasClass:function(e,t){if(!e||!e.className)return!1;var i=e.className.split(/\s+/);return-1!=o.indexOf(i,t)},parents:function(e,t){if(!e)return null;var i=e.parentNode;return i===document?null:(this.hasClass(i,t)||(i=this.parents(i,t)),i)},isObj:function(e){return"[object Object]"==Object.prototype.toString.call(e)},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)}};function l(e){for(var t in this.Opt={title:"标题",leftText:"取消",rightText:"确定",saveFn:function(e){}},e)e[t]&&(this.Opt[t]=e[t]);this._y_start="",this._y_move="",this._y_end="",this.top_start=0,this.isMove=!1,this.elem_wrap=null,this.elem_leftBtn=null,this.elem_rightBtn=null,this.elem_contents=null,this.elem_mask=null;var i=this.Opt.bindElem.getAttribute("selectcache");this.selectcache=i?i.split(","):[],this.selectArr=[],this.init()}l.VERSION="1.0.0",l.defaultOpt={headerHeight:45,itemHeight:34},l.prototype={constructor:l,getItemTpl:function(e){for(var t="",i=0;i<e.length;i++)t+='<div class="pickerView-item">'+e[i]+"</div>";return t},getItemsTpl:function(e){var t=this.selectcache[this.selectArr.length]?this.selectcache[this.selectArr.length]:0;this.selectArr.push(t);var i="",s=-t*l.defaultOpt.itemHeight,n=this.getItemTpl(e);return i+='<div index="'+(this.selectArr.length-1)+'" class="pickerView-box-content"><div style="background-size:100% '+this.padding+'px;" class="pickerView-box-content-mask"></div><div style="top:'+this.padding+'px;" class="pickerView-box-content-indicator"></div><div style="padding:'+this.padding+"px 0;transform:translate3d(0,"+s+'px,0)" fieldIndex="0" class="pickerView-items">'+n+"</div></div>"},renderItems:function(e){var t="",i=e,s=o.isObj(e);s&&(i=Object.keys(e)),t+=this.getItemsTpl(i);var n=this.selectArr[this.selectArr.length-1];return s&&(t+=this.renderItems(e[i[n]])),t},getTpl:function(){var e='<div class="pickerView-mask"></div><div class="pickerView-box"><div class="pickerView-box-header"><div class="pickerView-box-header-left pickerView-box-header-btn">取消</div><div class="pickerView-box-header-title">'+this.Opt.title+'</div><div class="pickerView-box-header-right pickerView-box-header-btn">确定</div></div><div class="pickerView-box-content-wrap">';return e+=this.renderItems(this.Opt.data),e+="</div></div>"},init:function(){var r=this,e=document.getElementsByTagName("body")[0],t=document.createElement("div");t.className="pickerView-wrap",this.elem_wrap=t,this.padding=(.4*document.documentElement.clientHeight-l.defaultOpt.headerHeight-l.defaultOpt.itemHeight)/2,t.innerHTML=this.getTpl(),e.appendChild(t),this.elem_mask=this.elem_wrap.getElementsByClassName("pickerView-mask")[0],this.elem_contents=this.elem_wrap.getElementsByClassName("pickerView-box-content-wrap")[0],this.elem_leftBtn=this.elem_wrap.getElementsByClassName("pickerView-box-header-left")[0],this.elem_rightBtn=this.elem_wrap.getElementsByClassName("pickerView-box-header-right")[0],this.elem_contents.addEventListener("touchstart",function(e){r.moveObj=o.parents(e.target,"pickerView-box-content").children[2],r.touchstart(e),e.stopPropagation()},!1),this.elem_contents.addEventListener("touchmove",function(e){r.touchmove(e),e.stopPropagation(),e.preventDefault()},!1),this.elem_contents.addEventListener("touchend",function(e){r.touchend(e),e.stopPropagation()},!1),this.elem_mask.addEventListener("touchend",function(e){r.closeComponent(),e.stopPropagation(),e.preventDefault()},!1),this.elem_leftBtn.addEventListener("touchend",function(e){r.closeComponent(),e.stopPropagation(),e.preventDefault()},!1),this.elem_rightBtn.addEventListener("touchend",function(e){for(var t=[],i=0;i<r.elem_contents.children.length;i++){var s=r.elem_contents.children[i].children[2],n=0<s.children.length?s.children[r.selectArr[i]].innerText:"";t.push(n)}r.Opt.rightFn(t),r.closeComponent(),r.Opt.bindElem.setAttribute("selectcache",r.selectArr),e.stopPropagation(),e.preventDefault()},!1)},touchstart:function(e){this._y_start=e.touches[0].pageY,this.isMove=!1,this.top_start=parseInt(this.moveObj.style.transform.split(",")[1])},touchmove:function(e){this.isMove=!0,this._y_move=e.touches[0].pageY;var t=parseFloat(this._y_move)-parseFloat(this._y_start)+parseFloat(this.top_start);o.css(this.moveObj,{transform:"translate3d(0,"+t+"px,0)"}),this.top_end=t},touchend:function(e){if(this.isMove){this.isMove=!1;var t=this,i=l.defaultOpt.itemHeight,s=0<=this.top_end?1:-1,n=this.moveObj.parentNode.getAttribute("index"),r=Math.round(Math.abs(this.top_end)/i),a=s*(r*i);0<a?r=a=0:a<-(this.moveObj.children.length-1)*i&&(a=-(this.moveObj.children.length-1)*i,r=this.moveObj.children.length-1),this.selectArr[n]=r,this.moveObj.setAttribute("fieldIndex",r),this.moveObj.style.transition="0.3s cubic-bezier(0,0,0.2,1.15)",o.css(t.moveObj,{transform:"translate3d(0,"+a+"px,0)"}),t.changeNext(n),t.moveObj.addEventListener("transitionend",function(e){t.moveObj.style.transition=""},!1),t.moveObj.addEventListener("webkitTransitionEnd",function(e){t.moveObj.style.transition=""},!1)}},changeNext:function(e){for(var t=this.Opt.data,i=[],s=0;s<this.selectArr.length;s++){var n=this.elem_contents.children[s].children[2];if(e<s)o.css(n,{transform:"translate3d(0,0,0)"}),this.selectArr[s]=0,i=o.isObj(t)?Object.keys(t):t,n.innerHTML=this.getItemTpl(i),t=t[i[0]];else t=t[n.children[this.selectArr[s]].innerText]}},closeComponent:function(){document.getElementsByTagName("body")[0].removeChild(this.elem_wrap)}},window.PickerView=l}();